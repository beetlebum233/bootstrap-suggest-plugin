/**
 * bootstrap-suggest-plugin - v0.1.23
 * @description 这是一个基于 bootstrap 按钮式下拉菜单组件的搜索建议插件，必须使用于按钮式下拉菜单组件上。
 * @author [object Object]
 * @GitHub https://github.com/lzwme/bootstrap-suggest-plugin.git
 * @since 2018-03-01 15:03:04
 */

!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof exports&&"object"==typeof module)t(require("jquery"));else{if(!window.jQuery)throw new Error("Not found jQuery.");t(window.jQuery)}}(function(t){var e,n=t(window),i="ActiveXObject"in window,o=navigator.userAgent.match(/Chrome\/(\d+)/);o&&(o=+o[1]);var r=i||o>51,a="bsSuggest",l="onDataRequestSuccess",s="disabled",u=!0,d=!1;function f(t){return t.data()}function c(t,e){return void 0!==e?t.attr("alt",e):t.attr("alt")}function p(t,e){return void 0!==e?t.attr("data-id",e):t.attr("data-id")}function h(t,e,n){if(e&&e.key){var i,o,r=n.separator||",",a=p(t);n&&n.multiWord?((i=t.val().split(r))[i.length-1]=e.key,a?(o=a.split(r)).push(e.id):o=[e.id],p(t,o.join(r)).val(i.join(r)).focus()):p(t,e.id||"").val(e.key).focus(),t.data("pre-val",t.val()).trigger("onSetSelectValue",[e,(n.data.value||n._lastData.value)[e.index]])}}function v(t,e,o){if(e.is(":visible")){var r=t.parent(),a=r.height(),l=r.width();o.autoDropup&&setTimeout(function(){var i=t.offset().top,o=n.scrollTop(),a=e.height();n.height()+o-i<a&&i>a+o?r.addClass("dropup"):r.removeClass("dropup")},10);var s={};return"left"===o.listAlign?s={left:t.siblings("div").width()-l,right:"auto"}:"right"===o.listAlign&&(s={left:"auto",right:0}),i&&!o.showBtn&&(r.hasClass("dropup")?(s.top="auto",s.bottom=a):(s.top=a,s.bottom="auto")),o.autoMinWidth||(s.minWidth=l),e.css(s),t}}function y(t,e){var n,i,o;if(-1===e.indexId&&!e.idField||e.multiWord)return t;i=e.inputBgColor,o=e.inputWarnColor;var r=t.val(),a=t.data("pre-val");return p(t)||!r?(t.css("background",i||""),!r&&a&&t.trigger("onUnsetSelectValue").data("pre-val",""),t):(n=t.css("backgroundColor").replace(/ /g,"").split(",",3).join(","),~o.indexOf(n)||t.trigger("onUnsetSelectValue").data("pre-val","").css("background",o),t)}function g(t,e,n){var i,o,r=t.parent().find("tbody tr."+n.listHoverCSS);r.length&&((i=(r.index()+3)*r.height())>(o=+e.css("maxHeight").replace("px",""))||e.scrollTop()>o?i-=o:i=0,e.scrollTop(i))}function m(t,e){t.find("tr."+e.listHoverCSS).removeClass(e.listHoverCSS)}function w(t){var e,n=u;for(e in t)if("value"===e){n=d;break}return n?(window.console&&window.console.trace,d):t.value.length?t:d}function b(e,n){var i=n.effectiveFields;return!("__index"===e||i.length&&!~t.inArray(e,i))}function x(t,e,n,i){n.html('<div style="padding:10px 5px 5px">'+t+"</div>").show(),v(e,n,i)}function k(t,e,n){var i,o,a,l,s,u,d,f=t.parent().find("ul:eq(0)"),c=0,p=['<table class="table table-condensed table-sm" style="margin:0">'],h=e.value;if(!e||!(i=h.length))return n.emptyTip?x(n.emptyTip,t,f,n):f.empty().hide(),t;if(n._lastData&&JSON.stringify(n._lastData)===JSON.stringify(e)&&f.find("tr").length===i)return f.show(),v(t,f,n);if(n._lastData=e,n.showHeader){for(a in p.push("<thead><tr>"),h[0])b(a,n)&&(p.push("<th>",n.effectiveFieldsAlias[a]||a,0===c?"("+i+")":"","</th>"),c++);p.push("</tr></thead>")}for(p.push("<tbody>"),o=0;o<i;o++){for(a in c=0,l=[],s=(d=h[o])[n.idField]||"",u=d[n.keyField]||"",d)u||n.indexKey!==c||(u=d[a]),s||n.indexId!==c||(s=d[a]),c++,b(a,n)&&l.push('<td data-name="',a,'">',d[a],"</td>");p.push('<tr data-index="',d.__index||o,'" data-id="',s,'" data-key="',u,'">',l.join(""),"</tr>")}return p.push("</tbody></table>"),f.html(p.join("")).show(),setTimeout(function(){if(!r){var t=f.find("table:eq(0)"),e=0,n=0;f.height()<t.height()&&+f.css("minWidth").replace("px","")<f.width()&&(e=18,n=20),f.css("paddingRight",e),t.css("marginBottom",n)}},301),v(t,f,n),t}function S(e,n){n=n||"";var i=e._preAjax;i&&i.abort&&4!==i.readyState&&i.abort();var o={type:"GET",dataType:e.jsonp?"jsonp":"json",timeout:5e3};e.jsonp&&(o.jsonp=e.jsonp);var r,a=e.fnAdjustAjaxParam;if(t.isFunction(a)){if(r=a(n,e),d===r)return;t.extend(o,r)}return o.url=function(){if(!n||o.data)return o.url||e.url;var t="?";return/=$/.test(e.url)?t="":/\?/.test(e.url)&&(t="&"),e.url+t+encodeURIComponent(n)}(),e._preAjax=t.ajax(o).done(function(t){e.data=e.fnProcessData(t)}).fail(function(t){e.fnAjaxFail&&e.fnAjaxFail(t,e)})}function j(e,n,i,o){return i=t.trim(i),o.ignorecase&&(e=e.toLocaleLowerCase(),i=i.toLocaleLowerCase()),i&&(b(n,o)||(r=n,a=o,~t.inArray(r,a.searchFields)))&&(~i.indexOf(e)||o.twoWayMatch&&~e.indexOf(i));var r,a}var C={url:null,jsonp:null,data:{value:[]},indexId:0,indexKey:0,idField:"",keyField:"",autoSelect:u,allowNoKeyword:u,getDataMethod:"firstByUrl",delayUntilKeyup:d,ignorecase:d,effectiveFields:[],effectiveFieldsAlias:{},searchFields:[],twoWayMatch:u,multiWord:d,separator:",",delay:300,emptyTip:"",searchingTip:"搜索中...",autoDropup:d,autoMinWidth:d,showHeader:d,showBtn:u,inputBgColor:"",inputWarnColor:"rgba(255,0,0,.1)",listStyle:{"padding-top":0,"max-height":"375px","max-width":"800px",overflow:"auto",width:"auto",transition:"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"},listAlign:"left",listHoverStyle:"background: #07d; color:#fff",listHoverCSS:"jhover",clearable:d,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13,fnProcessData:function(t){return w(t)},fnGetData:function(e,n,i,o){var r,a,s,u,d={value:[]},f=o.fnPreprocessKeyword;if(e=e||"",t.isFunction(f)&&(e=f(e,o)),o.url){var c;o.searchingTip&&(c=setTimeout(function(){x(o.searchingTip,n,n.parent().find("ul"),o)},600)),S(o,e).done(function(t){i(n,o.data,o),n.trigger(l,t),"firstByUrl"===o.getDataMethod&&(o.url=null)}).always(function(){c&&clearTimeout(c)})}else{if(w(r=o.data))if(e){for(u=r.value.length,a=0;a<u;a++)for(s in r.value[a])if(r.value[a][s]&&j(e,s,r.value[a][s]+"",o)){d.value.push(r.value[a]),d.value[d.value.length-1].__index=a;break}}else d=r;i(n,d,o)}},fnAdjustAjaxParam:null,fnPreprocessKeyword:null,fnAjaxFail:null},D={init:function(n){var i=this;return void 0===(n=n||{}).showHeader&&n.effectiveFields&&n.effectiveFields.length>1&&(n.showHeader=u),(n=t.extend(u,{},C,n)).processData&&(n.fnProcessData=n.processData),n.getData&&(n.fnGetData=n.getData),"firstByUrl"===n.getDataMethod&&n.url&&!n.delayUntilKeyup&&S(n).done(function(t){n.url=null,i.trigger(l,t)}),t("#"+a).length||t("head:eq(0)").append('<style id="'+a+'">.'+n.listHoverCSS+"{"+n.listHoverStyle+"}</style>"),i.each(function(){var i,o,r,l,w,b,x,S=t(this),j=S.parent(),C=(l=n,w=(r=S).prev("i.clearable"),l.clearable&&!w.length&&(w=t('<i class="clearable glyphicon glyphicon-remove"></i>').prependTo(r.parent())),w.css({position:"absolute",top:12,right:l.showBtn?(r.next(".input-group-btn").width()||33)+2:12,zIndex:4,cursor:"pointer",fontSize:12}).hide()),D=j.find("ul:eq(0)");(b=S,x=n,!D.length||b.data(a)?d:(b.data(a,{options:x}),u))&&(n.showBtn||(S.css("borderRadius",4),j.css("width","100%").find(".btn:eq(0)").hide()),S.removeClass(s).prop(s,d).attr("autocomplete","off"),D.css(n.listStyle),n.inputBgColor||(n.inputBgColor=S.css("backgroundColor")),S.on("keydown",function(t){var e,i;if(D.is(":visible")){if(e=D.find("."+n.listHoverCSS),i="",m(D,n),t.keyCode===n.keyDown){if(e.length?e.next().length?i=f(e.next().mouseover()):n.autoSelect&&p(S,"").val(c(S)):i=f(D.find("tbody tr:first").mouseover()),g(S,D,n),!n.autoSelect)return}else if(t.keyCode===n.keyUp){if(e.length?e.prev().length?i=f(e.prev().mouseover()):n.autoSelect&&p(S,"").val(c(S)):i=f(D.find("tbody tr:last").mouseover()),g(S,D,n),!n.autoSelect)return}else t.keyCode===n.keyEnter?(i=e.html()?f(e):f(D.find("tbody tr:first").mouseover()),D.hide()):p(S,"");h(S,i,n)}else p(S,"")}).on("compositionstart",function(t){e=u}).on("compositionend",function(t){e=d}).on("keyup input paste",function(i){var r;i.keyCode&&y(S,n),~t.inArray(i.keyCode,[n.keyDown,n.keyUp,n.keyEnter])?S.val(S.val()):(clearTimeout(o),o=setTimeout(function(){e||(r=S.val(),t.trim(r)&&r===c(S)||(c(S,r),n.multiWord&&(r=r.split(n.separator).reverse()[0]),(r.length||n.allowNoKeyword)&&n.fnGetData(t.trim(r),S,k,n)))},n.delay||300))}).on("focus",function(){v(S,D,n)}).on("blur",function(){i||D.css("display","")}).on("click",function(){var e=S.val();if(t.trim(e)&&e===c(S)&&D.find("table tr").length)return D.show();D.is(":visible")||(n.multiWord&&(e=e.split(n.separator).reverse()[0]),(e.length||n.allowNoKeyword)&&n.fnGetData(t.trim(e),S,k,n))}),j.find(".btn:eq(0)").attr("data-toggle","").click(function(){var t="none";return D.css("display")===t&&(t="block",n.url?(S.click().focus(),D.find("tr").length||(t="none")):k(S,n.data,n)),D.css("display",t),d}),D.mouseenter(function(){i=1,S.blur()}).mouseleave(function(){i=0,S.focus()}).on("mouseenter","tbody tr",function(){return m(D,n),t(this).addClass(n.listHoverCSS),d}).on("mousedown","tbody tr",function(){var e=f(t(this));h(S,e,n),c(S,e.key),y(S,n),D.hide()}),C.length&&(C.click(function(){p(S,"").val(""),y(S,n)}),j.mouseenter(function(){S.prop(s)||C.show()}).mouseleave(function(){C.hide()})))})},show:function(){return this.each(function(){t(this).click()})},hide:function(){return this.each(function(){t(this).parent().find("ul:eq(0)").css("display","")})},disable:function(){return this.each(function(){t(this).attr(s,u).parent().find(".btn:eq(0)").prop(s,u)})},enable:function(){return this.each(function(){t(this).attr(s,d).parent().find(".btn:eq(0)").prop(s,d)})},destroy:function(){return this.each(function(){t(this).off().removeData(a).removeAttr("style").parent().find(".btn:eq(0)").off().show().attr("data-toggle","dropdown").prop(s,d).next().css("display","").off()})},version:function(){return"0.1.23"}};t.fn[a]=function(e){if("string"==typeof e&&D[e]){var n=u;return this.each(function(){if(!t(this).data(a))return n=d}),n||"init"===e||"version"===e?D[e].apply(this,[].slice.call(arguments,1)):this}return D.init.apply(this,arguments)}});
//# sourceMappingURL=bootstrap-suggest.min.js.map